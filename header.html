<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>آموزش فضای متریک</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
  <style>
    body { margin: 0; font-family: sans-serif; background: #050810; color: white; direction: rtl; }
    #header-canvas { width: 100%; height: 600px; } /* ارتفاع هدر */
    .overlay { position: absolute; top: 200px; width: 100%; text-align: center; pointer-events: none; }
    h1 { font-size: 4em; text-shadow: 0 0 20px #00ffff; }
    .sidebar { position: fixed; top: 600px; bottom: 0; right: 0; width: 250px; background: rgba(10,15,30,0.9); padding: 20px; overflow-y: auto; }
    .main-content { margin-right: 270px; padding: 40px; margin-top: 600px; }
  </style>
</head>
<body>

  <div id="header-canvas"></div>
  <div class="overlay"><h1>آموزش فضای متریک</h1></div>


  <div class="main-content">
    <h2>خوش آمدید!</h2>
    <p>اگر هدر بالا نمایش داده می‌شود، یعنی کد درست کار می‌کند.</p>
  </div>

  <script>
    let shapes = [];
    let points = [];
    let balls = [];

    function setup() {
      let canvas = createCanvas(windowWidth, 600, WEBGL);
      canvas.parent('header-canvas'); // خیلی مهم: canvas رو به div وصل کن

      // مکعب - منهتن
      shapes.push({ type: 'box', pos: createVector(200, 0, 0), size: 180, color: [255, 80, 180] });
      // هشت‌وجهی - چبیشف
      shapes.push({ type: 'octahedron', pos: createVector(-200, 0, 0), size: 180, color: [80, 255, 180] });

      // نقاط
      for (let i = 0; i < 25; i++) {
        points.push(p5.Vector.random3D().mult(random(500, 900)));
      }
      // توپ‌ها
      for (let i = 0; i < 6; i++) {
        let pos = p5.Vector.random3D().mult(random(400, 700));
        balls.push({ pos: pos, radius: random(100, 180) });
      }
    }

    function draw() {
      background(5, 8, 20);
      ambientLight(60);
      pointLight(150, 200, 255, 0, 0, 200);

      rotateY(frameCount * 0.004);
      rotateX(frameCount * 0.002);

      // رسم اشکال wireframe نئونی
      for (let s of shapes) {
        push();
        let offset = createVector(sin(frameCount * 0.012) * 60, cos(frameCount * 0.012) * 60, sin(frameCount * 0.012) * 40);
        translate(s.pos.x + offset.x, s.pos.y + offset.y, s.pos.z + offset.z);
        rotateY(frameCount * 0.008);
        rotateX(frameCount * 0.006);

        noFill();
        stroke(s.color);
        strokeWeight(6);

        if (s.type === 'box') box(s.size);
        else if (s.type === 'octahedron') {
          rotateX(PI/4);
          cone(s.size / sqrt(2), s.size * 1.5, 4, 1);
          rotateX(PI);
          cone(s.size / sqrt(2), s.size * 1.5, 4, 1);
        }
        pop();
      }

      // توپ‌های شفاف
      noFill();
      stroke(100, 200, 255, 70);
      strokeWeight(2);
      for (let b of balls) {
        push();
        translate(b.pos.x, b.pos.y, b.pos.z);
        sphere(b.radius);
        pop();
      }

      // نقاط
      noStroke();
      fill(150, 220, 255);
      for (let p of points) {
        push();
        translate(p.x, p.y, p.z);
        sphere(5);
        pop();
      }
    }

    function windowResized() {
      resizeCanvas(windowWidth, 600);
    }
  </script>
</body>
</html>